import pandas as pd
import numpy as np

def clean_quantities(value):
    """Convert float quantities to integers, preserving pipe-separated format."""
    # Handle NaN, None, or NOT_FOUND
    if pd.isna(value) or value == 'NOT_FOUND' or value == '':
        return value

    try:
        if isinstance(value, str) and '|' in value:
            # Split by pipe, convert each part to int, rejoin
            parts = value.split('|')
            cleaned_parts = [str(int(float(part.strip()))) for part in parts if part.strip()]
            return ' | '.join(cleaned_parts)
        else:
            # Single value - convert to int
            return int(float(value))
    except (ValueError, TypeError):
        # If conversion fails, return original value
        return value

# Apply the function to the column
df['LINE_ITEM_QUANTITIES'] = df['LINE_ITEM_QUANTITIES'].apply(clean_quantities)