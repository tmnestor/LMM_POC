%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#E8F4F8','primaryTextColor':'#2C3E50','primaryBorderColor':'#2C3E50','lineColor':'#34495E'}}}%%
flowchart LR
    subgraph Example["📊 Bank Statement Transactions"]
        direction TB
        GT["<b>Ground Truth (Correct Order)</b><br/>───────────────────────────<br/>Date: 16-Jul | 17-Jul | 18-Jul<br/>Desc: Woolworths | Salary | Pizza<br/>Amt: $45.20 | $3000 | $28.50"]
    end

    Example --> Scenario1
    Example --> Scenario2

    subgraph Scenario1["✅ Scenario 1: CORRECT ORDER"]
        direction TB
        S1E["<b>Extracted:</b><br/>Date: 16-Jul | 17-Jul | 18-Jul<br/>Desc: Woolworths | Salary | Pizza<br/>Amt: $45.20 | $3000 | $28.50"]
        S1PA["<b>Position-Aware F1:</b> 100%<br/>✓ All positions match"]
        S1PNA["<b>Position-Agnostic F1:</b> 100%<br/>✓ All values present"]
        S1E --> S1PA
        S1E --> S1PNA
    end

    subgraph Scenario2["❌ Scenario 2: WRONG ORDER"]
        direction TB
        S2E["<b>Extracted (dates shuffled):</b><br/>Date: 17-Jul | 16-Jul | 18-Jul<br/>Desc: Woolworths | Salary | Pizza<br/>Amt: $45.20 | $3000 | $28.50"]
        S2PA["<b>Position-Aware F1:</b> 33%<br/>❌ Only pos[2] matches<br/>⚠️ Date[0]=17-Jul ≠ Desc[0]=Woolworths<br/>💥 Semantic misalignment!"]
        S2PNA["<b>Position-Agnostic F1:</b> 100%<br/>❌ WRONG - misses error!<br/>All values exist but wrong alignment"]
        S2E --> S2PA
        S2E --> S2PNA
    end

    S1PA -.✓ Both correct.-> Conclusion
    S1PNA -.✓ Both correct.-> Conclusion
    S2PA -.✓ Detects error.-> Conclusion
    S2PNA -.❌ Fails to detect.-> Conclusion

    Conclusion["<b>💡 CRITICAL INSIGHT:</b><br/>Position-Agnostic F1 = 100% but data is SEMANTICALLY WRONG<br/>Position-Aware F1 = 33% and CORRECTLY identifies misalignment<br/><br/>Use Position-Aware F1 for ordered/temporal data!"]

    style Example fill:#E8F4F8,stroke:#2C3E50,stroke-width:3px
    style Scenario1 fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style Scenario2 fill:#FFE6E6,stroke:#C73E1D,stroke-width:2px
    style S1PA fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style S1PNA fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style S2PA fill:#FFF4E6,stroke:#F18F01,stroke-width:2px
    style S2PNA fill:#FFE6E6,stroke:#C73E1D,stroke-width:2px
    style Conclusion fill:#F0E6FF,stroke:#A23B72,stroke-width:3px
