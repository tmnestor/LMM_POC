%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#E8F4F8','primaryTextColor':'#2C3E50','primaryBorderColor':'#2C3E50','lineColor':'#34495E'}}}%%
flowchart LR
    Header["<b>WHY POSITION-AWARE<br/>F1 IS CRITICAL</b>"]

    Header --> Correct
    Header --> Wrong

    subgraph Correct["✅ CORRECT ALIGNMENT"]
        direction TB
        C1["<b>Extracted:</b><br/>Date: ['16-Jul', '18-Jul', '20-Jul']<br/>Desc: ['Woolworths', 'Pizza', 'Utilities']<br/>Amt: ['45.20', '28.50', '127.80']"]
        C2["<b>Check:</b><br/>16-Jul↔Woolworths↔$45.20✓<br/>18-Jul↔Pizza↔$28.50✓<br/>20-Jul↔Utilities↔$127.80✓"]
        C3["<b>Metrics:</b><br/>Position-Aware: 100%✅<br/>Position-Agnostic: 100%✅"]
    end

    subgraph Wrong["❌ DATES SHUFFLED"]
        direction TB
        W1["<b>Extracted (ERROR):</b><br/>Date: ['18-Jul', '16-Jul', '20-Jul']❌<br/>Desc: ['Woolworths', 'Pizza', 'Utilities']<br/>Amt: ['45.20', '28.50', '127.80']"]
        W2["<b>Check:</b><br/>18-Jul↔Woolworths❌WRONG!<br/>16-Jul↔Pizza❌WRONG!<br/>20-Jul↔Utilities✓Only this OK"]
        W3["<b>Metrics:</b><br/>Position-Aware: 33%⚠️<br/>Position-Agnostic: 100%❌<br/>FAILS to detect error!"]
    end

    Insight["<b>🎯 INSIGHT:</b><br/>Position-Aware detects<br/>semantic misalignment<br/><br/>Position-Agnostic scores<br/>100% on CORRUPT data!<br/><br/>Date[i]↔Desc[i]↔Amt[i]<br/>must be SAME transaction"]

    Correct --> Insight
    Wrong --> Insight

    style Header fill:#E8F4F8,stroke:#2C3E50,stroke-width:3px
    style Correct fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style Wrong fill:#FFE6E6,stroke:#C73E1D,stroke-width:2px
    style Insight fill:#F0E6FF,stroke:#A23B72,stroke-width:3px
