%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#E8F4F8','primaryTextColor':'#2C3E50','primaryBorderColor':'#2C3E50','lineColor':'#34495E','secondaryColor':'#FFF4E6','tertiaryColor':'#F0E6FF'}}}%%
flowchart LR
    Start([What type of field?])

    Start --> Single{Single Value<br/>or List?}

    Single -->|Single Value| FieldType{Field Type?}
    Single -->|List| OrderMatter{Does order<br/>matter?}

    FieldType -->|ID/ABN| Exact[Exact Match<br/>❌ No tolerance]
    FieldType -->|Money| Monetary[Monetary Comparison<br/>✓ 1% tolerance]
    FieldType -->|Date| DateNorm[Date Normalization<br/>✓ Format flexible]
    FieldType -->|Text| Fuzzy[ANLS/Fuzzy Match<br/>✓ OCR tolerance]

    OrderMatter -->|Yes<br/>Transactions| PosAware[Position-Aware F1<br/>⚠️ Order + Value]
    OrderMatter -->|No<br/>Metadata| PosAgnostic[Position-Agnostic F1<br/>✓ Value only]
    OrderMatter -->|Cross-field<br/>validation| Correlation[Correlation-Aware F1<br/>🔗 Multi-field]

    Exact --> Result1[Score: 0.0 or 1.0]
    Monetary --> Result2[Score: 0.0 to 1.0]
    DateNorm --> Result3[Score: 0.0 or 1.0]
    Fuzzy --> Result4[Score: 0.0 to 1.0]
    PosAware --> Result5[F1: Precision × Recall<br/>Penalizes order errors]
    PosAgnostic --> Result6[F1: Precision × Recall<br/>Ignores order]
    Correlation --> Result7[Combined F1 + Alignment<br/>Validates relationships]

    style Start fill:#E8F4F8,stroke:#2C3E50,stroke-width:3px
    style Exact fill:#FFE6E6,stroke:#C73E1D,stroke-width:2px
    style Monetary fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style DateNorm fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style Fuzzy fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style PosAware fill:#FFF4E6,stroke:#F18F01,stroke-width:2px
    style PosAgnostic fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
    style Correlation fill:#F0E6FF,stroke:#A23B72,stroke-width:2px
