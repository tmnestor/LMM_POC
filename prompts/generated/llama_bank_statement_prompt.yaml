prompts:
  # Generic bank statement prompt (fallback)
  bank_statement:
    name: "Generated Llama Bank Statement Extraction"
    description: "Generated prompt for bank statement documents - taxpayer expense claims (5 fields)"
    prompt: |
      You are an expert document analyzer. Extract structured data from this bank statement for taxpayer expense claims.

      CRITICAL INSTRUCTIONS:
      - Extract ONLY DEBIT/WITHDRAWAL transactions (money OUT) for expense tracking
      - IGNORE deposits and credits (money IN)
      - Output ONLY the structured data below
      - Start immediately with DOCUMENT_TYPE
      - Stop immediately after TRANSACTION_AMOUNTS_PAID

      OUTPUT FORMAT (5 FIELDS):

      DOCUMENT_TYPE: [document type (BANK_STATEMENT) or NOT_FOUND]
      STATEMENT_DATE_RANGE: [statement period or date range or NOT_FOUND]
      LINE_ITEM_DESCRIPTIONS: [DEBIT transaction descriptions using | separator - format: debit1 | debit2 | debit3 or NOT_FOUND]
      TRANSACTION_DATES: [DEBIT transaction dates separated by " | " or NOT_FOUND]
      TRANSACTION_AMOUNTS_PAID: [DEBIT transaction amounts separated by " | " or NOT_FOUND]

      RULES:
      - Use exact text from document
      - CRITICAL: Use ONLY pipe separators (|) for lists
      - Extract ONLY debits/withdrawals/expenses (money OUT)
      - Skip deposits/credits/income (money IN)
      - Be conservative: use NOT_FOUND if field is truly missing

      STOP AFTER TRANSACTION_AMOUNTS_PAID. Do not add explanations or comments.

  # Flat Table Bank Statements (continuous table format)
  bank_statement_flat:
    name: "Flat Table Bank Statement Extraction"
    description: "Optimized for flat table bank statements - taxpayer expense claims (5 fields)"
    prompt: |
      You are an expert document analyzer specializing in bank statement extraction.
      Extract structured data from the transaction table for taxpayer's expense claims.

      CONVERSATION PROTOCOL:
      - Start your response immediately with "DOCUMENT_TYPE: BANK_STATEMENT"
      - Do NOT include conversational text like "I'll extract..." or "Based on the document..."
      - Do NOT use bullet points, numbered lists, asterisks, or markdown formatting (no **, no ##, no 1., no -)
      - Output ONLY the structured extraction data below
      - End immediately after "TRANSACTION_AMOUNTS_PAID:" with no additional text
      - NO explanations, NO comments, NO additional text

      ## STEP 1: LOCATE THE TRANSACTION TABLE
      Focus on the main transaction table in the document, typically located in the center/body area.
      The table will have columns including: Date, Description, Debit/Withdrawal, Credit/Deposit, Balance.
      Ignore page headers, footers, account summaries, and advertisement sections.

      ## STEP 2: IDENTIFY DEBIT TRANSACTIONS
      TARGET COLUMNS: Date column + Description column + Debit/Withdrawal amount column

      For each table row, check:
      - Does it have a value in the DEBIT/WITHDRAWAL column? → Extract this row
      - Does it have a value in the CREDIT/DEPOSIT column only? → SKIP this row
      - Keywords indicating DEBIT: withdrawal, payment, purchase, debit, fee, charge, ATM, EFTPOS, transfer out
      - Keywords indicating CREDIT to skip: deposit, credit, salary, transfer in, interest received, refund

      ## STEP 3: EXTRACT ROW-BY-ROW
      For EACH debit transaction row identified in Step 2:
      1. Extract the DATE from the date column (format as DD/MM/YYYY)
      2. Extract the DESCRIPTION from the description column (exact text)
      3. Extract the AMOUNT from the debit/withdrawal column (include $ symbol)
      4. Add each extracted value to its respective field with " | " separator

      CRITICAL CONSTRAINTS:
      - Every transaction row has a date, but EITHER a debit OR credit value (never both)
      - The row may have a running balance at the end - ignore balance column
      - Extract ONLY rows with debit/withdrawal amounts (money OUT)
      - IGNORE rows with credit/deposit amounts (money IN)
      - The number of entries in TRANSACTION_DATES, LINE_ITEM_DESCRIPTIONS, and TRANSACTION_AMOUNTS_PAID must match exactly
      - If multiple transactions occur on the same date, extract each as a separate entry
      - Process rows in chronological order (top to bottom in table)

      EXPLICIT EXCLUSIONS (DO NOT EXTRACT):
      - Salary deposits or payments (money IN)
      - Interest received or interest payment (money IN)
      - Refunds or returns (money IN)
      - Any row with value in CREDIT/DEPOSIT column
      - Any transaction that increases account balance

      ## MANDATORY OUTPUT FORMAT (5 FIELDS):

      DOCUMENT_TYPE: BANK_STATEMENT
      STATEMENT_DATE_RANGE: [statement date range from document]
      TRANSACTION_DATES: [actual dates in DD/MM/YYYY format separated by " | "]
      LINE_ITEM_DESCRIPTIONS: [actual transaction descriptions separated by " | "]
      TRANSACTION_AMOUNTS_PAID: [actual amounts with $ separated by " | "]

      STOP AFTER TRANSACTION_AMOUNTS_PAID. Do not add explanations or comments.

  # Date-Grouped Bank Statements (transactions grouped under date headers)
  bank_statement_date_grouped:
    name: "Date-Grouped Bank Statement Extraction"
    description: "Optimized for date-grouped bank statements - taxpayer expense claims (5 fields)"
    prompt: |
      You are an expert document analyzer specializing in bank statement extraction.
      Extract transaction data from this Australian bank statement for taxpayer expense claims.

      CONVERSATION PROTOCOL:
      - Start your response immediately with "DOCUMENT_TYPE: BANK_STATEMENT"
      - Do NOT include conversational text like "I'll extract..." or "Based on the document..."
      - Do NOT use bullet points, numbered lists, asterisks, or markdown formatting (no **, no ##, no 1., no -)
      - Output ONLY the structured extraction data below
      - End immediately after "TRANSACTION_AMOUNTS_PAID:" with no additional text
      - NO explanations, NO comments, NO additional text

      ## STEP 1: LOCATE DATE-GROUPED TRANSACTION SECTIONS
      Focus on the main transaction area in the document body.
      This statement has transactions grouped under date headers like "Thu 04 Sep 2025" or "Mon 01 Sep 2025".
      Under each date header, there will be transaction rows with: Description, Amount columns.
      Ignore page headers, footers, account summaries, and advertisement sections.

      ## STEP 2: IDENTIFY DEBIT TRANSACTIONS UNDER EACH DATE
      For each date header section:
      TARGET DATA: Transaction description + Transaction amount (look for negative amounts or explicit debit indicators)

      For each transaction under a date header, check:
      - Is this a DEBIT/WITHDRAWAL transaction (money OUT)? → Extract this transaction
      - Is this a CREDIT/DEPOSIT transaction (money IN)? → SKIP this transaction
      - Keywords indicating DEBIT: withdrawal, payment, purchase, debit, fee, charge, ATM, EFTPOS, transfer out, card purchase
      - Keywords indicating CREDIT to skip: deposit, credit, salary, transfer in, interest received, refund, income

      ## STEP 3: EXTRACT TRANSACTION-BY-TRANSACTION
      For EACH debit transaction identified in Step 2:
      1. Extract the DATE from the date header above it (convert to DD/MM/YYYY format)
      2. Extract the DESCRIPTION from the transaction row (exact text)
      3. Extract the AMOUNT from the transaction row (include $ symbol, ensure it's a debit)
      4. Add each extracted value to its respective field with " | " separator

      CRITICAL CONSTRAINTS:
      - Extract ONLY DEBIT/WITHDRAWAL transactions (money OUT) for expense tracking
      - IGNORE deposits and credits (money IN) completely
      - The number of entries in TRANSACTION_DATES, LINE_ITEM_DESCRIPTIONS, and TRANSACTION_AMOUNTS_PAID must match exactly
      - If multiple debit transactions occur under the same date header, extract each as a separate entry with the same date
      - Process transactions in chronological order (top to bottom through date headers)
      - Multiple transactions can share the same date (common in date-grouped format)

      EXPLICIT EXCLUSIONS (DO NOT EXTRACT):
      - Salary deposits or payments (money IN)
      - Interest received or interest payment (money IN)
      - Refunds or returns (money IN)
      - Any credit/deposit transaction
      - Any transaction that increases account balance

      ## MANDATORY OUTPUT FORMAT (5 FIELDS):

      DOCUMENT_TYPE: BANK_STATEMENT
      STATEMENT_DATE_RANGE: [statement date range from document]
      TRANSACTION_DATES: [actual dates in DD/MM/YYYY format separated by " | "]
      LINE_ITEM_DESCRIPTIONS: [actual transaction descriptions separated by " | "]
      TRANSACTION_AMOUNTS_PAID: [actual amounts with $ separated by " | "]

      STOP AFTER TRANSACTION_AMOUNTS_PAID. Do not add explanations or comments.
